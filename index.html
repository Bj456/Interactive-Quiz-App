<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Interactive Quiz App</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
    <div id="loading-overlay" class="hidden">
        <div class="spinner"></div>
        <p>Your custom quiz is being generated by AI...</p>
    </div>

    <div class="container">
        <!-- Error Message Display -->
        <div id="error-message" class="hidden"></div>

        <!-- Start Screen -->
        <div id="start-screen" class="screen">
            <div class="start-header">
                <svg class="logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zM9.5 16.5L5 12l1.5-1.5L9.5 13.5l7-7L18 8l-8.5 8.5z"/></svg>
                <h1>AI Quiz Generator</h1>
            </div>
            <p class="subtitle">Craft a personalized quiz on any topic in seconds.</p>
            <form id="quiz-settings-form">
                <!-- Your form inputs here -->
            </form>
        </div>

        <!-- Quiz Screen -->
        <div id="quiz-screen" class="screen hidden">
            <!-- Quiz content here -->
            <button id="download-pdf" class="btn btn-primary" style="margin-top:10px;">Download PDF</button>
        </div>

        <!-- Score Screen -->
        <div id="score-screen" class="screen hidden">
            <!-- Score content -->
        </div>
    </div>

    <footer>
        <p>Developed by <strong><a href="mailto:bhaskarjoshi2024@gmail.com">Teacher Bhaskar Joshi</a></strong></p>
    </footer>

    <!-- Font Script -->
    <script src="NotoSansDevanagari-Regular-normal.js"></script> <!-- Root में रखा गया -->

    <script>
    document.getElementById('download-pdf').addEventListener('click', () => {
        generatePDF(window.questions || [], "Teacher Bhaskar Joshi");
    });

    function generatePDF(questions, developerName) {
        if (!questions || questions.length === 0) return alert("No questions available to generate PDF.");

        const { jsPDF } = window.jspdf;
        const doc = new jsPDF('p', 'mm', 'a4');
        const pageWidth = doc.internal.pageSize.getWidth();
        const pageHeight = doc.internal.pageSize.getHeight();

        const margin = 10;
        const colGap = 10;
        const lineHeight = 6;
        const colWidth = (pageWidth - margin * 2 - colGap) / 2;
        const questionsPerPage = 20;

        let xLeft = margin;
        let xRight = margin + colWidth + colGap;
        let yStart = margin + 10;
        let pageCount = 1;

        // ✅ Font Integration
        doc.addFileToVFS("NotoSansDevanagari-Regular-normal.ttf", font); // font variable from JS
        doc.addFont("NotoSansDevanagari-Regular-normal.ttf", "NotoSans", "normal");
        doc.setFont("NotoSans");

        for (let i = 0; i < questions.length; i++) {
            const q = questions[i];
            const posInPage = i % questionsPerPage;
            const isLeft = posInPage < 10;
            const x = isLeft ? xLeft : xRight;
            const rowIndex = posInPage % 10;
            let y = yStart + rowIndex * (lineHeight * (q.answers.length + 1) + 2);

            doc.setFontSize(10);
            doc.text(`${i + 1}. ${q.question}`, x, y);

            q.answers.forEach((opt, idx) => {
                doc.text(`(${String.fromCharCode(97 + idx)}) ${opt}`, x + 2, y + lineHeight * (idx + 1));
            });

            if ((posInPage === questionsPerPage - 1) || (i === questions.length - 1)) {
                doc.setFontSize(8);
                doc.text(`Developed by ${developerName}`, pageWidth / 2, pageHeight - 12, { align: 'center' });
                doc.text(`Page ${pageCount}`, pageWidth / 2, pageHeight - 6, { align: 'center' });

                if (i !== questions.length - 1) {
                    doc.addPage();
                    pageCount++;
                }
            }
        }

        doc.save('AI_Quiz.pdf');
    }
    </script>

    <script src="script.js"></script>
</body>
</html>
